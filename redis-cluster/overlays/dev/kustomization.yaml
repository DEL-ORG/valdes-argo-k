apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - ../../base

patches:
  - target:
      kind: Application
      name: redis-cluster
    patch: |-
      - op: replace
        path: /spec/source/helm/values
        value: |
          architecture: "cluster"
          cluster:
            nodes: 3       # smaller dev setup: 2 masters + 1 replica
          replica:
            replicaCount: 1
          auth:
            enabled: true
            existingSecret: redis-auth
          persistence:
            enabled: true
            size: 2Gi
          service:
            type: ClusterIP
